/*
 Script to create external table definition

 Between the Header record and the Trailer record in an AMA CS file are
 multiple AMA CS records,
 each containing the following fields:

 */

CREATE TABLE "XDV_SINGTEL_AMA_CS_ET" (
    "GSM_SUBSCIBER_NUMBER" VARCHAR2(20 BYTE),
    "CALL_DATE" TIMESTAMP (8),
    "SERVICE_TYPE" VARCHAR2(4 BYTE),
    "SUPPL_SERVICE_CODE" VARCHAR2(2 BYTE),
    "LAC" VARCHAR2(5 BYTE),
    "SPARE1" VARCHAR2(1 BYTE),
    "ANSWER_TIME" TIMESTAMP (6),
    "DISCONNECT_TIME" TIMESTAMP (6),
    "DURATION_" TIMESTAMP (6),
    "CALL_CLASS" VARCHAR2(2),
    "CHARGE_INDICATION" VARCHAR2(1),
    "CALL_DIRECTION" VARCHAR2(1 BYTE),
    "GSM_SUBSCRIBER_CLASS" VARCHAR2(2),
    "TRAFFIC_CLASS" VARCHAR2(3 BYTE),
    "MULTIMEDIA_CALL" VARCHAR2(1),
    "CALL_DISTANCE" VARCHAR2(2),
    "MIDNIGHT_PASS" VARCHAR2(1),
    "PHASE_RECOVERY" VARCHAR2(1),
    "OTHER_SUBSCRIBER_NUMBER" VARCHAR2(24 BYTE),
    "OTHER_SUBSCRIBER_CATEGORY" VARCHAR2(2),
    "RECORD_TYPE" VARCHAR2(1 BYTE),
    "HOT_BILLING_INDICATOR" VARCHAR2(1),
    "GSM_SUBSCRIBER_IMSI" VARCHAR2(15 BYTE),
    "TERMINATING_REASON" VARCHAR2(5 BYTE),
    "CALL_EVENTS" VARCHAR2(15 BYTE),
    "MOBILE_ROAMING_NUMBER" VARCHAR2(18 BYTE),
    "CALL_SEQUENCE_NUMBER" VARCHAR2(6 BYTE),
    "MSC_ID" VARCHAR2(1 BYTE),
    "SPARE2" VARCHAR2(1 BYTE),
    "SPEECH_CODER_VERSION" VARCHAR2(1 BYTE),
    "SUBSCRIBER_TYPE" VARCHAR2(1 BYTE),
    "DISCONNECTION_PARTY" VARCHAR2(1 BYTE),
    "SUPPL_SERVICE_ACTION_CODE" VARCHAR2(1 BYTE),
    "OPERATOR_CODE" VARCHAR2(1 BYTE),
    "CHANNEL_CODING" VARCHAR2(1 BYTE),
    "ISDN_DATA_RATE" VARCHAR2(1 BYTE),
    "IN_MARKING" VARCHAR2(1 BYTE),
    "IMEI" VARCHAR2(15 BYTE),
    "PSTN_ROUTE" VARCHAR2(7 BYTE),
    "REGIONAL_SERVICE_USED" VARCHAR2(1),
    "SUBSCRIPTION_TYPE" VARCHAR2(3 BYTE),
    "FREQUENCY_BASED_SUPPORT" VARCHAR2(3 BYTE),
    "XCLI_INDICATOR" VARCHAR2(1),
    "GUARANTEED_BIT_RATE" VARCHAR2(2 BYTE),
    "MAXIMUM_BIT_RATE_DOWNLINK" VARCHAR2(2 BYTE),
    "MAXIMUM_BIT_RATE_UPLINK" VARCHAR2(2 BYTE),
    "RANAP_CAUSE_CODE" VARCHAR2(3 BYTE),
    "IMEI_SOFTWARE_VERSION" VARCHAR2(2 BYTE),
    "SPARE3" VARCHAR2(1 BYTE),
    "HSCSD_RADIO_CHANNEL_USED" VARCHAR2(3 BYTE),
    "START_CELL_ID" VARCHAR2(5 BYTE),
    "END_CELL_ID" VARCHAR2(5 BYTE),
    "DIALLED_NUMBER" VARCHAR2(24 BYTE),
    "PLUS_KEY_INDICATOR" VARCHAR2(1 BYTE),
    "PREPAID_SERVICE_INDICTR" VARCHAR2(1),
    "CDR_TYPE" VARCHAR2(3 BYTE),
    "CHARGE_START_TIME" TIMESTAMP (6),
    "CHARGE_DURATION" TIMESTAMP (6),
    "CALL_CHARGE_ATOMIC_RBS" VARCHAR2(7 BYTE),
    "SPARE4" VARCHAR2(1 BYTE),
    "SERVICE_CLASS" VARCHAR2(5 BYTE),
    "SERVICE_FEATURE_CODE" VARCHAR2(5 BYTE),
    "NUMBER_INCOMPLETE_INDICATOR" VARCHAR2(1 BYTE),
    "FAMILY_FRIEND_INDICATOR" VARCHAR2(6 BYTE),
    "RDRCT_ACC_FOR_PREPAID_SMS_MO" VARCHAR2(20 BYTE),
    "HANDOVER_GSM2G_TO_UMTS3G" VARCHAR2(2),
    "HANDOVER_UMTS3G_TO_GSM2G" VARCHAR2(2),
    "TOTAL_DURATION_IN_2G_NETWORK" VARCHAR2(8 BYTE),
    "TOTAL_DURATION_IN_3G_NETWORK" VARCHAR2(8 BYTE),
    "SUBSCR_NUM_FOR_SMS_CALLS" VARCHAR2(20 BYTE),
    "REDIRECTION_COUNTER" VARCHAR2(1 BYTE),
    "EMLPP_PRIORITY_LEVEL" VARCHAR2(1 BYTE),
    "START_NETWORK" VARCHAR2(1 BYTE),
    "DEDICATED_ACCOUNT_NUMBER" VARCHAR2(1),
    "ACCUMULATED_DURATION" TIMESTAMP (6),
    "DEDICTD_ACCNT_VAL_BEFORE_CALL" VARCHAR2(7 BYTE),
    "DEDICTD_ACCNT_VAL_AFTER_CALL" VARCHAR2(7 BYTE),
    "ACCUMD_VAL_OF_ACCUM_1" VARCHAR2(7 BYTE),
    "ACCUMD_VAL_OF_ACCUM_2" VARCHAR2(7 BYTE),
    "ACCUMD_VAL_OF_ACCUM_3" VARCHAR2(7 BYTE),
    "ACCUMD_VAL_OF_ACCUM_4" VARCHAR2(7 BYTE),
    "ACCUMD_VAL_OF_ACCUM_5" VARCHAR2(7 BYTE),
    "DELTA_VALUE_OF_CALL_EVENT" VARCHAR2(7 BYTE),
    "CALL_SETUP_RESULT_CODE" VARCHAR2(2 BYTE),
    "CALL_CHARGE" VARCHAR2(7 BYTE),
    "ACCOUNT_VALUE_BEFORE_CALL" VARCHAR2(7 BYTE),
    "ACCOUNT_VALUE_AFTER_CALL" VARCHAR2(7 BYTE),
    "ACCUMULATOR_IDENTIFIER" VARCHAR2(1 BYTE),
    "VALID_ACCUMULATORS" VARCHAR2(5 BYTE),
    "CAMEL_SERVICE_USED" VARCHAR2(1 BYTE),
    "CAMEL_SERVER_SCF_ADDRESS" VARCHAR2(18 BYTE),
    "CAMEL_SERVICE_LEVEL" VARCHAR2(2 BYTE),
    "CAMEL_SERVICE_KEY" VARCHAR2(8 BYTE),
    "DEF_CALL_HNDL_INDICTR" VARCHAR2(1 BYTE),
    "CAMEL_CALL_RFRNCE_NUM" VARCHAR2(16 BYTE),
    "CAMEL_MSC_ADDRESS" VARCHAR2(18 BYTE),
    "CAMEL_INIT_CALL_FORWRD" VARCHAR2(1 BYTE),
    "CAMEL_CALL_PARTY_NUM" VARCHAR2(18 BYTE),
    "CAMEL_DEST_ADDR" VARCHAR2(18 BYTE),
    "CAMEL_SMCS_ADDR" VARCHAR2(18 BYTE),
    "FREE_FORMAT_DATA" VARCHAR2(20 BYTE),
    "SPARE5" VARCHAR2(3 BYTE))
   ORGANIZATION EXTERNAL
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY "XDV_EXT_GEN_DATA_DIR"
      ACCESS PARAMETERS
      ( RECORDS DELIMITED BY NEWLINE
        BADFILE     XDV_EXT_GEN_LOG_DIR:'singtel_ama_cs.bad'
        DISCARDFILE XDV_EXT_GEN_LOG_DIR:'singtel_ama_cs.dis'
        LOGFILE     XDV_EXT_GEN_LOG_DIR:'singtel_ama_cs_log'
        LOAD WHEN (RECORD_TYPE = 'C')
        FIELDS NOTRIM (
	        GSM_SUBSCIBER_NUMBER POSITION(1:20) CHAR(20),
	        CALL_DATE POSITION(21:28) CHAR(8) DATE_FORMAT TIMESTAMP MASK "YYYYMMDD",
			SERVICE_TYPE POSITION(29:32) CHAR(4),
			SUPPL_SERVICE_CODE POSITION(33:34) CHAR(2),
			LAC POSITION(35:39) CHAR(5),
			SPARE1 POSITION(40:40) CHAR(1),
			ANSWER_TIME POSITION(41:46) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			DISCONNECT_TIME POSITION(47:52) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			DURATION_ POSITION(53:58) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			CALL_CLASS POSITION(59:60) CHAR(2),
			CHARGE_INDICATION POSITION(61:61) CHAR(1),
			CALL_DIRECTION POSITION(62:62) CHAR(1),
			GSM_SUBSCRIBER_CLASS POSITION(63:64) CHAR(2),
			TRAFFIC_CLASS POSITION(65:67) CHAR (3),
			MULTIMEDIA_CALL POSITION(68:68) CHAR(1),
			CALL_DISTANCE POSITION(69:70) CHAR(2),
			MIDNIGHT_PASS POSITION(71:71) CHAR(1),
			PHASE_RECOVERY POSITION(72:72) CHAR(1),
			OTHER_SUBSCRIBER_NUMBER POSITION(73:96) CHAR(24),
			OTHER_SUBSCRIBER_CATEGORY POSITION(97:98) CHAR(2),
			RECORD_TYPE POSITION(99:99) CHAR(1),
			HOT_BILLING_INDICATOR POSITION(100:100) CHAR(1),
			GSM_SUBSCRIBER_IMSI POSITION(101:115) CHAR(15),
			TERMINATING_REASON POSITION(116:120) CHAR(5),
			CALL_EVENTS POSITION(121:135) CHAR(15),
			MOBILE_ROAMING_NUMBER POSITION(136:153) CHAR(18),
			CALL_SEQUENCE_NUMBER POSITION(154:159) CHAR(6),
			MSC_ID POSITION(160:160) CHAR(1),
			SPARE2 POSITION(161:161) CHAR(1),
			SPEECH_CODER_VERSION POSITION(162:162) CHAR(1),
			SUBSCRIBER_TYPE POSITION(163:163) CHAR(1),
			DISCONNECTION_PARTY POSITION(164:164) CHAR(1),
			SUPPL_SERVICE_ACTION_CODE POSITION(165:165) CHAR(1),
			OPERATOR_CODE POSITION(166:166) CHAR(1),
			CHANNEL_CODING POSITION(167:167) CHAR(1),
			ISDN_DATA_RATE POSITION(168:168) CHAR(1),
			FORLOPP POSITION(169:169) CHAR(1),
			IN_MARKING POSITION(170:170) CHAR(1),
			IMEI POSITION(171:185) CHAR(15),
			PSTN_ROUTE POSITION(186:192) CHAR(7),
			REGIONAL_SERVICE_USED POSITION(193:193) CHAR(1),
			SUBSCRIPTION_TYPE POSITION(194:196) CHAR(3),
			FREQUENCY_BASED_SUPPORT POSITION(197:199) CHAR(3),
			XCLI_INDICATOR POSITION(200:200) CHAR(1),
			GUARANTEED_BIT_RATE POSITION(201:202) CHAR(2),
			MAXIMUM_BIT_RATE_DOWNLINK POSITION(203:204) CHAR(2),
			MAXIMUM_BIT_RATE_UPLINK POSITION(205:206) CHAR(2),
			RANAP_CAUSE_CODE POSITION(207:209) CHAR(3),
			IMEI_SOFTWARE_VERSION POSITION(210:211) CHAR(2),
			SPARE3 POSITION(212:212) CHAR(1),
			HSCSD_RADIO_CHANNEL_USED POSITION(213:215) CHAR(3),
			START_CELL_ID POSITION(216:220) CHAR(5),
			END_CELL_ID POSITION(221:225) CHAR(5),
			DIALLED_NUMBER POSITION(226:249) CHAR(24),
			PLUS_KEY_INDICATOR POSITION(250:250) CHAR(1),
			PREPAID_SERVICE_INDICTR POSITION(251:251) CHAR(1),
			CDR_TYPE POSITION(252:254) CHAR(3),
			CHARGE_START_TIME POSITION(255:260) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			CHARGE_DURATION POSITION(261:266) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			CALL_CHARGE_ATOMIC_RBS POSITION(267:271) CHAR(7),
			SPARE4 POSITION(272:286) CHAR(1),
			SERVICE_CLASS POSITION(287:291) CHAR(5),
			SERVICE_FEATURE_CODE POSITION(292:296) CHAR(5),
			NUMBER_INCOMPLETE_INDICATOR POSITION(297:297) CHAR(1),
			FAMILY_FRIEND_INDICATOR POSITION(298:303) CHAR(6),
			RDRCT_ACC_FOR_PREPAID_SMS_MO POSITION(304:323) CHAR(20),
			HANDOVER_GSM2G_TO_UMTS3G POSITION(324:325) CHAR(2),
			HANDOVER_UMTS3G_TO_GSM2G POSITION(326:327) CHAR(2),
			TOTAL_DURATION_IN_2G_NETWORK POSITION(328:335) CHAR(8),
			TOTAL_DURATION_IN_3G_NETWORK POSITION(336:343) CHAR(8),
			SUBSCR_NUM_FOR_SMS_CALLS POSITION(344:363) CHAR(20),
			REDIRECTION_COUNTER POSITION(364:364) CHAR(1),
			EMLPP_PRIORITY_LEVEL POSITION(365:365) CHAR(1),
			START_NETWORK POSITION(366:366) CHAR(1),
			DEDICATED_ACCOUNT_NUMBER POSITION(367:367) CHAR(1),
			ACCUMULATED_DURATION POSITION(368:373) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
			DEDICTD_ACCNT_VAL_BEFORE_CALL POSITION(374:380) CHAR(7),
			DEDICTD_ACCNT_VAL_AFTER_CALL POSITION(381:387) CHAR(7),
			ACCUMD_VAL_OF_ACCUM_1 POSITION(388:394) CHAR(7),
			ACCUMD_VAL_OF_ACCUM_2 POSITION(395:401) CHAR(7),
			ACCUMD_VAL_OF_ACCUM_3 POSITION(402:408) CHAR(7),
			ACCUMD_VAL_OF_ACCUM_4 POSITION(409:415) CHAR(7),
			ACCUMD_VAL_OF_ACCUM_5 POSITION(416:422) CHAR(7),
			DELTA_VALUE_OF_CALL_EVENT POSITION(423:429) CHAR(7),
			CALL_SETUP_RESULT_CODE POSITION(430:431) CHAR(2),
			CALL_CHARGE POSITION(432:438) CHAR(7),
			ACCOUNT_VALUE_BEFORE_CALL POSITION(439:445) CHAR(7),
			ACCOUNT_VALUE_AFTER_CALL POSITION(446:452) CHAR(7),
			ACCUMULATOR_IDENTIFIER POSITION(453:453) CHAR(1),
			VALID_ACCUMULATORS POSITION(454:458) CHAR(5),
			CAMEL_SERVICE_USED POSITION(459:459) CHAR(1),
			CAMEL_SERVER_SCF_ADDRESS POSITION(460:477) CHAR(18),
			CAMEL_SERVICE_LEVEL POSITION(478:479) CHAR(2),
			CAMEL_SERVICE_KEY POSITION(480:487) CHAR(8),
			DEF_CALL_HNDL_INDICTR POSITION(488:488) CHAR(1),
			CAMEL_CALL_RFRNCE_NUM POSITION(489:504) CHAR(16),
			CAMEL_MSC_ADDRESS POSITION(505:522) CHAR(18),
			CAMEL_INIT_CALL_FORWRD POSITION(523:523) CHAR(1),
			CAMEL_CALL_PARTY_NUM POSITION(524:541) CHAR(18),
			CAMEL_DEST_ADDR POSITION(542:559) CHAR(18),
			CAMEL_SMCS_ADDR POSITION(560:577) CHAR(18),
			FREE_FORMAT_DATA POSITION(578:597) CHAR(20),
			SPARE5 POSITION(598:600) CHAR(3)))
			LOCATION ( "XDV_EXT_GEN_DATA_DIR":'singtel_ama_cs_dat')
    )
   REJECT LIMIT UNLIMITED PARALLEL 32767;

quit