
  CREATE TABLE "XDV_SINGTEL_AMA_PS_ET"
  (
  	"RECORD_TYPE" VARCHAR2(1 BYTE),
	"CALL_SEQUENCE_NUMBER" NUMBER(*,0),
	"GSM_SUBSCRIBER_NUMBER_MSISDN" VARCHAR2(20),
	"SERVED_IMSI" VARCHAR2(16 BYTE),
	"SERVED_IMEI" VARCHAR2(20 BYTE),
	"CHARGE_INDICATION" NUMBER(*,0),
	"START_DATE_OF_CALL" TIMESTAMP (6),
	"END_DATE_OF_CALL" TIMESTAMP (6),
	"PDP_CONTEXT_START_TIME" TIMESTAMP (6),
	"PDP_CONTEXT_STOP_TIME" TIMESTAMP (6),
	"NETWORK_INITIATED_PDP_CONTEXT" VARCHAR2(1 BYTE),
	"GGSN_ADDRESS" VARCHAR2(45 BYTE),
	"SGSN_ADDRESS" VARCHAR2(45 BYTE),
	"SPARE1" VARCHAR2(2 BYTE),
	"ACCESS_POINT_NAME_NETWORK_ID" VARCHAR2(63),
	"PDP_TYPE" VARCHAR2(2),
	"SERVED_PDP_ADDRESS" VARCHAR2(45 BYTE),
	"DYNAMIC_ADDRESS_FLAG" VARCHAR2(1 BYTE),
	"TOTAL_GGSN_UPLINK_TRAFFIC" NUMBER(*,0),
	"TOTAL_GGSN_DOWNLINK_TRAFFIC" NUMBER(*,0),
	"TOTAL_2G_SGSN_UPLINK_TRAFFIC" NUMBER(*,0),
	"TOTAL_2G_SGSN_DOWNLINK_TRAFFIC" NUMBER(*,0),
	"TOTAL_GGSN_DURATION" VARCHAR2(8),
	"TOTAL_2G_SGSN_DURATION" VARCHAR2(8),
	"TWO_G_QOS_REQUESTED" VARCHAR2(6 BYTE),
	"TWO_G_QOS_FIRST_NEGOTIATED" VARCHAR2(6 BYTE),
	"TOTAL_3G_SGSN_DURATION" VARCHAR2 (8),
	"FIRST_ROUTING_AREA" VARCHAR2(5 BYTE),
	"FIRST_CELL_ID" VARCHAR2(5 BYTE),
	"LAST_ROUTING_AREA" VARCHAR2(5 BYTE),
	"LAST_CELL_ID" VARCHAR2(5 BYTE),
	"TERMINATING_REASON" VARCHAR2(5 BYTE),
	"ANONYMOUS_ACCESS_INDICATOR" VARCHAR2(1 BYTE),
	"GGSN_NODE_ID" VARCHAR2(20),
	"SGSN_NODE_ID" VARCHAR2(20),
	"CHARGING_ID" VARCHAR2(10),
	"CALL_TYPE" VARCHAR2(1 BYTE),
	"ACCESS_POINT_NAME_OPERATOR_ID" VARCHAR2(37 BYTE),
	"CHARGING_CHARACTERISTICS" VARCHAR2(2),
	"FIRST_LOCATION_AREA_CODE" VARCHAR2(5),
	"LAST_LOCATION_AREA_CODE" VARCHAR2(5),
	"MS_NETWORK_CAPABILITY" VARCHAR2(8),
	"TOTAL_3G_SGSN_UPLINK_TRAFFIC" VARCHAR2(15),
	"TOTAL_3G_SGSN_DOWNLINK_TRAFFIC" VARCHAR2(15),
	"TREE_G_QOS_REQUESTED" VARCHAR2(24),
	"APN_SELECTION_MODE" VARCHAR2(1),
	"TYPE_OF_SUBSCRIBER" VARCHAR2(1),
	"TRAFFIC_CHARGING_FACTOR" VARCHAR2(3),
	"CONTENT_PROVIDER_CODE" VARCHAR2(5),
	"ATOMIC_TRANSACTION_CODE" VARCHAR2(3),
	"SGSN_CHARGING_CHARACTERISTICS" VARCHAR2(1),
	"GGSN_CHARGING_CHARACTERISTICS" VARCHAR2(1),
	"RNC_UNSENT_DOWNLINK_VOLUME" NUMBER,
	"SGSN_PLMN_IDENTIFIER" VARCHAR2(6),
	"TREE_G_QOS_FIRST_NEGOTIATED" VARCHAR2(24),
	"ECDS_CONTEXT_ID" VARCHAR2(20),
	"ECDS_CONTENT_PRO_RATE" VARCHAR2(3),
	"ECDS_ENCODING_SPEED" VARCHAR2(4),
	"ECDS_CONTENT_CHARGEABLE_INDIC" VARCHAR2(1),
	"SINGLE_APN_CONTENT_RATE" VARCHAR2(5),
	"HSDPA_RATE" VARCHAR2(3),
	"SPARE2" VARCHAR2(124)
	)
   ORGANIZATION EXTERNAL
    ( TYPE ORACLE_LOADER
      DEFAULT DIRECTORY "XDV_EXT_GEN_DATA_DIR"
      ACCESS PARAMETERS
      ( RECORDS DELIMITED BY NEWLINE
        BADFILE     XDV_EXT_GEN_LOG_DIR:'singtel_ama_ps.bad'
        DISCARDFILE XDV_EXT_GEN_LOG_DIR:'singtel_ama_ps.dis'
        LOGFILE     XDV_EXT_GEN_LOG_DIR:'singtel_ama_ps_log'
        LOAD WHEN (RECORD_TYPE = 'G'
					AND PDP_CONTEXT_STOP_TIME!=BLANKS
                    AND END_DATE_OF_CALL!=BLANKS)
        FIELDS
        NOTRIM (
		RECORD_TYPE POSITION(1:1) CHAR(1),
		CALL_SEQUENCE_NUMBER POSITION(2:7) INTEGER EXTERNAL,
		GSM_SUBSCRIBER_NUMBER_MSISDN POSITION(8:27) CHAR(20),
		SERVED_IMSI POSITION(28:43) CHAR(16),
		SERVED_IMEI POSITION(44:63) CHAR(20),
		CHARGE_INDICATION POSITION(64:64) INTEGER EXTERNAL,
		START_DATE_OF_CALL POSITION(65:72) CHAR(8) DATE_FORMAT TIMESTAMP MASK "YYYYMMDD",
		END_DATE_OF_CALL POSITION(73:80) CHAR(8) DATE_FORMAT TIMESTAMP MASK "YYYYMMDD",
		PDP_CONTEXT_START_TIME POSITION(81:86) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
		PDP_CONTEXT_STOP_TIME POSITION(87:92) CHAR(6) DATE_FORMAT TIMESTAMP MASK "HH24MISS",
		NETWORK_INITIATED_PDP_CONTEXT POSITION(93:93) CHAR(1),
		GGSN_ADDRESS POSITION(94:138) CHAR(45),
		SGSN_ADDRESS POSITION(139:183) CHAR(45),
		SPARE1 POSITION(184:185) CHAR(2),
		ACCESS_POINT_NAME_NETWORK_ID POSITION(186:248) CHAR(63),
		PDP_TYPE POSITION(249:250) CHAR(2),
		SERVED_PDP_ADDRESS POSITION(251:295) CHAR(45),
		DYNAMIC_ADDRESS_FLAG POSITION(296:296) CHAR(1),
		TOTAL_GGSN_UPLINK_TRAFFIC POSITION(297:311) INTEGER EXTERNAL,
		TOTAL_GGSN_DOWNLINK_TRAFFIC POSITION(312:326) INTEGER EXTERNAL,
		TOTAL_2G_SGSN_UPLINK_TRAFFIC POSITION(327:341) INTEGER EXTERNAL,
		TOTAL_2G_SGSN_DOWNLINK_TRAFFIC POSITION(342:356) INTEGER EXTERNAL,
		TOTAL_GGSN_DURATION POSITION(357:364) CHAR(8),
		TOTAL_2G_SGSN_DURATION POSITION(365:372) CHAR(8),
		TWO_G_QOS_REQUESTED POSITION(373:378) CHAR(6),
		TWO_G_QOS_FIRST_NEGOTIATED POSITION(379:384) CHAR(6),
		TOTAL_3G_SGSN_DURATION POSITION(385:392) CHAR(8),
		FIRST_ROUTING_AREA POSITION(393:397) CHAR(5),
		FIRST_CELL_ID POSITION(398:402) CHAR(5),
		LAST_ROUTING_AREA POSITION(403:407) CHAR(5),
		LAST_CELL_ID POSITION(408:412) CHAR(5),
		TERMINATING_REASON POSITION(413:417) CHAR(5),
		ANONYMOUS_ACCESS_INDICATOR POSITION(418:418) CHAR(1),
		GGSN_NODE_ID POSITION(419:438) CHAR(20),
		SGSN_NODE_ID POSITION(439:458) CHAR(20),
		CHARGING_ID POSITION(459:468) CHAR(10),
		CALL_TYPE POSITION(469:469) CHAR(1),
		ACCESS_POINT_NAME_OPERATOR_ID POSITION(470:506) CHAR(37),
		CHARGING_CHARACTERISTICS POSITION(507:508) CHAR(2),
		FIRST_LOCATION_AREA_CODE POSITION(509:513) CHAR(5),
		LAST_LOCATION_AREA_CODE POSITION(514:518) CHAR(5),
		MS_NETWORK_CAPABILITY POSITION(519:526) CHAR(8),
		TOTAL_3G_SGSN_UPLINK_TRAFFIC POSITION(527:541) CHAR(15),
		TOTAL_3G_SGSN_DOWNLINK_TRAFFIC POSITION(542:556) CHAR(15),
		TREE_G_QOS_REQUESTED POSITION(557:580) CHAR(24),
		APN_SELECTION_MODE POSITION(581:581) CHAR(1),
		TYPE_OF_SUBSCRIBER POSITION(582:582) CHAR(1),
		TRAFFIC_CHARGING_FACTOR POSITION(583:585) CHAR(3),
		CONTENT_PROVIDER_CODE POSITION(586:590) CHAR(5),
		ATOMIC_TRANSACTION_CODE POSITION(591:593) CHAR(3),
		SGSN_CHARGING_CHARACTERISTICS POSITION(594:594) CHAR(1),
		GGSN_CHARGING_CHARACTERISTICS POSITION(595:595) CHAR(1),
		RNC_UNSENT_DOWNLINK_VOLUME POSITION(596:610) INTEGER EXTERNAL,
		SGSN_PLMN_IDENTIFIER POSITION(611:616) CHAR(6),
		TREE_G_QOS_FIRST_NEGOTIATED POSITION(617:640) CHAR(24),
		ECDS_CONTEXT_ID POSITION(641:660) CHAR(20),
		ECDS_CONTENT_PRO_RATE POSITION(661:663) CHAR(3),
		ECDS_ENCODING_SPEED POSITION(664:667) CHAR(4),
		ECDS_CONTENT_CHARGEABLE_INDIC POSITION(668:668) CHAR(1),
		SINGLE_APN_CONTENT_RATE POSITION(669:673) CHAR(5),
		HSDPA_RATE POSITION(674:676) CHAR(3),
		SPARE2 POSITION(677:800) CHAR(124)
        )
		)
	    LOCATION ("XDV_EXT_GEN_DATA_DIR":'singtel_ama_ps_dat')
   )
   REJECT LIMIT UNLIMITED PARALLEL 32767;

quit